# 取り組んだ課題一覧
- REST
# わかったこと
- web apiとは
webサービスが提供している昨日やデータをプログラムが外部から読み書きしやすい形でメッセージ送受信を行うようにする規約または用いたサービス
- apiとは
    Application Programming Interface　昨日やデータを外部から呼び出して利用できるようにした”規約”
-  api化するメリット
      -  第三者が利活用して新たな機能やサービスを開発
      -  APIエコノミーの実現による自社サービスの発展につながる
- api化するデメリット(APIエコノミーの実現のために無条件に公開してもよいのか？)
      -  一番の問題は入るはずの利益が入らなくなる = **アクティブユーザの減少・リソースの圧迫**・データの盗難等
         - 原因・対策
             アクティブユーザ減少....他サービスが劣っていたりで自社サービスの評判も連鎖で落とされている・該当サービスに対してのAPIキーの停止
             リソースの圧迫....該当サービスに対してAPIのレートリミットを掛けたりする
- HTTPリクエストは[リクエストライン・ヘッダ・ボディ]の三要素で構成される
    - リクエストライン
            送信に関する基本情報（一行目に当たる）
            [メソッド・リクエストURL・HTTP versionで]で構成
          - HTTPメソッド
                ８種類存在、CRUDに則り,Create:[POST/PUT]/Read:GET/Update:PUT/Delete:DELETEは最低限
                POSTとPUTの違いはリソース名が確定しているかの違いである。
    - ヘッダ
        cookieなど様々なメタデータを含む
    - ボディ
        任意のデータを格納
- 冪等性とは
  副作用の有無は問わないが、何度実行しても同じ状態が再現される性質。
-  RESTfulとは
  RESTで求められる原則に従属していること
- RESTとは
  REpresentational State Transfer (分散型システムにおける設計原則群　)
    - REST原則
         ※論文中は７種類ある
        - クライアント/サーバ
            UI(リクエスト)とデータ(レスポンス)で関心事を分離する特徴性を持つ
            クライアントがトリガーでサーバが基本受け身である。（現代はサーバ側からpushすることもある）
        - ステートレス
        サーバはリクエストだけでコンテキストを理解できること
          - サーバセッションは使わず、状態はクライアント上に保存される。**リクエストに状態情報を含むことでリクエストが独立する**
        メリット：単一だけ見ればいいので監視が楽。障害発生した場合も回復が容易
        デメリット：単一のリクエストで完結するため、リクエストデータに重複が発生する
        - キャッシュ制御
        クライアントはレスポンスをキャッシュできる。キャッシュを適切に行うことで必要な情報だけリクエストすればよくなる、効率性向上。
        メリット：ユーザ体験・リソース効率・拡張性の向上
        デメリット：古いデータを戻してしまうと、システムに対する信頼性の低下に繋がる
        - 統一インターフェイス
            ４つの制約から成り立つ。[リソースの識別・表現を用いたリソース操作・自己記述メッセージ・アプリケーション状態エンジンとしてのハイパーメディア(HATEOAS)]
            - リソースの識別
            ※ここでいうリソースとは名前が付けられるあらゆるものである。(例：画像,人など・抽象的なもの：天気,最新)
            URLを用いてサーバに保存されたデータを識別すること(リソースを識別する)
            - 表現を用いたリソース操作
            ※ここでいう表現とはクライアントへ返却されるレスポンスやサーバへPOSTするデータ等の断面
            断面情報を利用し、サーバ上のデータを操作すること。
            - 自己記述メッセージ
            ※自己記述とはデータ自身がデータの中身を説明している
            メッセージ内容が何であるか、ヘッダに記述されていること。(レスポンスに含まれるメタ情報で内容がどのようなものか分かる)
            - アプリケーション状態エンジンとしてのハイパーメディア(HATEOAS)
            ※ Hypermedia As The Engine Of Application State(レスポンスに現在の状態を踏まえた関連するハイパーリンクが含まれている/例：検索結果ページにおける「次ページ」のようなリンク)
        
            統一インターフェイスのメリット：異なるブラウザでも同じような画面を表示できる・システムアーキテクチャが簡素化され、わかりやすくなる
            デメリット：標準化によって効率が犠牲となる(冗長になる)
        - 階層化システム
            多層アーキテクチャの構成(web→AP→DB)のこと。
            メリット：カプセル化（コンポーネント）にすることで、進化と再利用が促進できる
            デメリット：データ処理にオーバヘッドが発生(処理速度の低下)
        - コードオンデマンド
            クライアントコードをダウンロードして実行できる。リリース後にクライアントコードを変更できる（HTMLの更新,JSの更新でサーバをアップデートしたらクライアントも勝手にアップデートしたデータをダウンロードし新しい環境を手に入れる）
             メリット：リリース済みのクライアントに対して機能追加ができる・サーバの負荷が下がる
             デメリット：評価環境が複雑になる。   
- REST API設計レベル
設計レベルは四段階存在する。
  - level 0
  HTTPを使用している
  - level 1
  リソースの概念を導入している
  リソースごとにURLを分離している。
  - level 2 
  HTTPの動詞を導入している
  リソースに対してHTTPメソッドを使ったCRUD操作が行われている
  - level 3
  HATEOASの概念を導入している
  レスポンスに現在の状態に関するハイパーリンクが含まれている。
- URI設計
    ### 考慮すること
    - 短く入力し易い
     不要な単語や重複を削除することで入力ミスを防ぐ
    - 人間が読んで理解できる
    意味分からん略称などを使わない
    - 小文字のみで構成される
    - 単語はハイフンで結合する
    そもそも単語の連結を行うくらいならURIを見直してみる(構成別にするとか)
    - 単語は複数形を利用する
    URIで表現しているのは**リソースの集合**のため
    - エンコードを必要とする文字は利用しない
    URIから意味が理解できない(人間が理解できない)
    - サーバ側のアーキテクチャが反映しない
    悪意あるユーザに脆弱性をつかれる可能性がある
    - 改造しやすい
    - ルールに統一性がある
- HTTPメソッドの適用
URIがリソースを示すのに対し、HTTPメソッドはリソースに対する操作を示す
URIは同じでHTTPメソッドを変えることで操作を変える
- クエリとパスの使い分け
リソースを特定するパラメータには２種類存在する。
一意なリソースを表すのに必要か？→パスパラメータ使用
省略可能か？→クエリパラメータ使用
  - クエリパラメータ
  URLの末尾にある`?`に続くキーバリュー[GET http://~.com/users?page=2]
  - パスパラメータ
  URL中に埋め込まれるパラメータ[GET http://~.com/users/123]   

-  ステータスコード
  処理結果の概要を把握するもの、５分類化している。
  - 100番台：情報
        - 100 Continue
            サーバがリクエストを受け取り、まだサーバから拒否されていないことを示す
        - 101 switching protocol
        プロトコルの切り替えを要求している
  - 200番台：成功
        - 200 OK
        リクエストの成功
        - 201 Created
            リクエストが成功し、新しいリソースが作成されたことを示す。ヘッダのLocationに新しいリソースのURLを含める
        - 202 Accepted
            非同期ジョブを受け付けたことを示す。実際の処理結果は別途で受け取る
        - 204 No Content
            リクエストは成功したが、レスポンスデータがないことを示す。クライアント側のビューを変更する必要がないことを示す。
  - 300番台：リダイレクト
    いくつか存在するが。API利用者はリダイレクトを実装していないことが多いので、REST APIでは基本的に利用していない
  - 400番台：クライアントサイドに起因するエラー
    - 400 Bad Request
        その他エラー。曖昧すぎるがつまり起因はクライアントにあるよ！と言っているようなもの
    - 401 Unauthorized
        クライアント側が認証されていないことを示す
    - 403 Forbidden
        リソースに対するアクセス権が認可されていないことを示す。逆説的にリソースの存在を示していることにもなるので、存在を隠蔽したい場合は 404を用いる
    - 404 Not Found
        リクエストされたリソースが存在しないことを示す
    - 409 Conflict
        リソースが競合していて処理が完了できない
    - 429 Too Many Request
        アクセス回数が制限回数(rate limit)を超えたため処理ができない
  - 500番台：サーバサイドに起因するエラー
      - 500 Internal Server Error
          サーバサイドのアプリケーションエラーが発生してことを示す
      - 503 Service Unavailable
          サービスが一時的に利用できないことを示す。メンテナンスや高負荷状態でダウンしてる時
![](https://i.gyazo.com/badda2b24f35457c4b5fc16a3c01eb9b.png)
# 次やること
- REST
# 感じたこと
- RESTはプログラミング言語のパッケージなのかと思っていたが、オブジェクト指向プログラミングのような"API設計における思想"の一種であった。
- Railsとかで苦労しないようしっかりインプットしたいが、なかなかに情報量がある
### 学習時間

3h ほど
累計:334h



